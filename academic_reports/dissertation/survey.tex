\section{Context survey}
\label{s:contextsurvey}
\hspace{10pt} This section critically reviews the project's related work. First, it studies the capabilities of phone sensing. Second, it explores different energy measurement methods and presents other research's energy measurement results. Finally, the approaches to energy-efficient phone sensing are studied. The section also tries to identify possible improvements in each of those areas. 

\subsection{Phone sensing}

Althouth physical sensors are noisy and often inaccurate, the meaningful information may be extracted from. \hspace{10pt} Sensor-based \textbf{activity recognition} aims to determine a user's physical activity e.g. sitting, walking or driving. Most of this activity recognition is based on accelerometer data, though other sensors may be utilized\ (e.g. compass). As a part of Google Play Services, activity recognition service is provided in Android, AcitivityRecognitionClient \cite{android:activityrecognition}. At the moment, the service is capable of detecting five different types of activities: 
 \begin{itemize}
  	\item a user is in vehicle.
    \item a user is on bike.
    \item a user is on foot.
    \item a user is still.
    \item a mobile phone is tilting.
  \end{itemize}
  
ActivityRecognitionClient delivers the list of activities with the corresponding probabilities of them taking place at a given moment. The service requires Internet connectivity to work, since Google Play Services do. Furthermore, research community has also established algorithms for detecting other activities:
 \begin{itemize}
  	\item a user is taking elevator up or down \cite{Wang:unsupervised}.
    \item a user is ascending or descending the staircase \cite{Wang:unsupervised}.
    \item a user is on escalator \cite{Wang:unsupervised}.
    \item a user is running \cite{miluzzo:cenceme}.
    \item a different position of a phone e.g., chest pocket or trousers pocket \cite{kawahara:positions}.
  \end{itemize}

Activity recognition algorithms are still in its early days. Some studies propose different algorithms for recognizing the same activity\ (e.g., walking \cite{benabdesslem:senseless} \cite{rachuri:socialsense} \cite{Kwapisz2011} ). Furthermore, the implementation of the proposed algorithms arbitrarily selects algorithms' different parameters: threshold values\ (e.g., if a standard deviation is more than 30, then a user is walking) and a window size\ (e.g., classify weather a user is moving over the period of two seconds). Lastly, the evaluation of the algorithms is usually made on the limited amount of devices with few users, who hold their phones in constrained positions (e.g. trouser pocket). 

Activity recognition may be leveraged for \textbf{navigation}. Detected activities may assist in localizing a user e.g., if a user is taking an elevator and there is one elevator nearby, he can be easily localized. Furthermore, physical sensors may provide useful information for navigation: the speed of user's movement\ (accelerometer) and its direction\ (compass and gyroscope). Those information may be utilized to estimate a user's relative position. For example, if a user is moving north in straight line with the speed of 5 meters per second. After a minute, his position is estimated to be 100 meters north in a straight line from the previous position.  This process is called Pedestrian Dead Reckoning\ (PDR) and is often combined with absolute localization systems\ (GPS or Wi-Fi based localization). In GAC \cite{youssef:gac}, infrequent GPS samples calibrate a user's relative position calculated by PDR (accelerometer and compass data). An absolute localization system may be also replaced by other mechanisms. Constandache et al.\cite{constandache:localization} proposes an inertial navigation system which does not rely on GPS nor Wi-Fi based localization. Instead it leverages electronic maps, which are equipped with additional information on how sensors readings should be changing while a user is taking a specific path. The system uses directional information\ (compass and gyroscope) for identifying a path. For example, a user may be localized to be on curved path if his compass' readings steadily change in the same direction. Directional information for maps may be automatically generated and pre-fetched to mobile phone.

Inertial navigation is further leveraged for \textbf{indoor localization}. UnLoc \cite{Wang:unsupervised} identifies certain locations basing on their sensors signatures\ (also SensLoc \cite{kim:sensloc} ). For example, the elevator has a specific accelerometer signature or a computer lab may create characteristic magnetic field. After those landmarks with their fingerprints are learned in an unsupervised manned by the system, they enable to localize a user if he returns to those places. The similar idea has been previously applied in Wi-Fi based indoor localization systems e.g., Park et al.\cite{park:organic}. The hybrid solution, which combines Wi-Fi fingerprints and other sensors signatures has been also suggested in Radu et al.\cite{radu:hybrid}. Lastly, SurroundSense \cite{azizyan:surroundsense} leverages the ambient sound as fingerprints for localization.

Another idea to improve capabilities of phone sensing is to put \textbf{higher quality sensors} on a mobile phone. Google is currently working on Project Tango \cite{google:tango}, which materializes this idea. The prototype of that project can localize a user and build the map of the environment basing on mobile phone's high quality sensors and camera. 		
		
Although sensors provide much information, it is very difficult to extract meaningful information out of them. There are many practical challenges for activity recognition\ (different algorithms for the same activity, their various parameters and their generality). They also affect other phone sensing applications e.g., inertial navigation. It is believed that those challenges may be addressed by comparing and evaluating algorithms against big sensor data set of different activities. This idea has been proposed before in Hossmann et al.\cite{hossmann:bigdatasets} and successfully executed in other fields e.g. Reality Mining \cite{eagle:realitymining}. In phone sensing, Kwapisz et al. \cite{Kwapisz2011} is believed to collect the biggest data set\ (29 different users). However, the all data collection was constrained to one phone's position: front pants leg pocket. 
		
\subsection{Energy measurement}
\hspace{10pt} To improve the energy efficiency of phone sensing, an accurate method for measuring it needs to be established. This task is relatively easy for Nokia phones. Nokia Energy Profiler \cite{nokia:profiler}, an application delivered by Nokia,  accurately measures power consumption and is widely used by research community \cite{kjaergaard:entracked} \cite{lu:jigsaw} \cite{li:status}. However, Google does not provide any equivalent application for Android smartphones. This makes the task of energy measurement difficult. The first subsection reviews the methods for measuring power consumption available on Android, whereas the second subsection demonstrates energy measurement results of other studies.

\subsubsection{Energy measurement methods}
\hspace{10pt} \textbf{The Power Monitor} is a hardware power meter delivered by MoonSooon PowerSolutions \cite{monsoon:powermonitor}.  It is designed for analyzing power of single lithium\ (Li) batteries\ (all Android phones). Although the tool provides accurate measurements, it can only be used in a lab environment e.g., it cannot measure energy consumption of GPS sampling while a user is moving outdoor. Its price is also high\ (771 \$), and thus, it cannot be directly used by mobile phone users. To alleviate this problem, mobile phone vendors establish power profiles of the device as a part of their manufacturing process. Next, those power profiles are placed onto a mobile device \cite{android:powerprofiles} and may be further utilized by battery usage applications.

Most of battery usage applications on Android smartphones leverages a \textbf{power model} to determine the current energy consumption of a device. Those applications continuously query the state of hardware components such as CPU, wireless card or display to estimate their energy demands. For example, wireless card may be switched off, switched on or scanning. Each of those states has assigned its energy consumption e.g. if switched off, it costs 2 mA power; if switched on, it costs 31 mA power and while scanning, it costs 100 mA. All of those energy consumption values are available in power profiles provided by mobile phone vendors (it was described in the previous paragraph). The applications aggregate energy consumption values of current states of all components to estimate the total current power consumption of a device. Those applications include PowerTutor \cite{zhang:powertutor} and Battery Monitor Widget \cite{googleplay:batterymonitorwidget}. Although they provide online energy measurements and it can by used by users, those measurements are often inaccurate. With time, the power profiles, provided by vendors, can change as battery itself does. To easy this problem, PowerTutor adopts its algorithm basing on a device model. However, it only supports three mobile phones: HTC G1, HTC G2 and Nexus one. Finally, the battery usage applications based on a power model are not applicable to phone sensing: power profiles do not contain any information on a state of physical sensors e.g. PowerTutor does not support accelerometer. 

\textbf{Battery life} may be also measured to estimate a device's power consumption. If a mobile device has high energy demands, its battery life should deplete fast. BetterBatteryStats \cite{googleplay:betterbatterystats} and Battery Stats Plus \cite{googleplay:batterystatsplus} use battery life as metrics to monitor mobile applications' energy consumption. This idea was also utilized in research community. SenseLess \cite{benabdesslem:senseless} compares the energy efficiency of different sensors basing on how long the full battery depletion takes while only one sensor is being sampled. This approach provides the accurate approximation of a mobile's power consumption and does not require any additional hardware. Furthermore, it may be undertaken by mobile phone user and works for physical sensors. However, the measurement may be time consuming. In SenseLess, it took 170 hours to fully deplete the battery life while all sensors are switched off. Since 2009\ (Senseless), the battery life has increased and Android operating system has become more energy efficient. The full battery depletion is likely to take even longer for modern mobile phones.

\textbf{TrepnProfiler} \cite{qualcomm:trepnprofiler} is a new method for measuring power consumption of a device. The tool, provided by Qualcomm, is a low level software, which runs only on SnapDragon chips, which are also provided by Qualcomm. The tool provides accurate measurements including physical sensors and may be used by mobile phone users. However, the tool is still relatively new and works only on mobile phones with SnapDragon chips.

\begin{table}[H]
	\centering
    \begin{tabular}{| c | c | c | c | c | c | c |}
    \hline
    Method & Accurate & Duration & \shortstack{Physical \\ Sensors} &   \shortstack{All mobile \\ phones} & \shortstack{ Outside \\ lab environment} \\ \hline
    The Power Monitor & \checkmark & Immediate & \checkmark &  \checkmark  & -\\ \hline
    Power model & - & Immediate & - & \checkmark & \checkmark \\ \hline
    \rowcolor{green}
     Battery life & \checkmark & Long & \checkmark & \checkmark & \checkmark \\ \hline
    TrepnProfiler & \checkmark & Immediate & \checkmark & - & \checkmark \\ \hline
    \end{tabular}
    \caption{The comparison of energy measurement methods. Using battery life as metrics is the most suitable method for the project.}
	\label{table:energymeasurementmethods}
\end{table}
	
In this subsection, four different methods for energy measurement were reviewed. The characteristics of them are summarized in the Table \ref{table:energymeasurementmethods}. Since accurate energy measurements outside of the lab environment are needed, \textbf{measuring battery life was chosen for the project}.  To reduce experiments' time, the 1\% percentage battery depletion is proposed instead of the full battery depletion. This method is further explained in Section \ref{s:design:measurements:method}. TrepnProfiler would also satisfy the project's requirements, but the tool does not work on all Android devices.

\subsubsection{Energy measurement results}
\hspace{10pt} The energy efficiency of the sensors has been examined before \cite{benabdesslem:senseless} \cite{constandache:localization} \cite{wang:eemss} \cite{chon:smartdc}. Regardless of energy measurement methods used in those studies, they provide similar results e.g. the \plotref{senseless} shows the energy consumption of different sensors established in SenseLess \cite{benabdesslem:senseless}. All of the studies confirm that accelerometer is more energy-efficient than microphone, which consumes less power than GPS and IEEE 802.11 scanning, which are more energy-efficient than video camera.

\plot{senseless}

Depending on the energy measurement method used in other studies, they provide more details on sensors' energy consumption. For example, GAC \cite{youssef:gac}, which utilizes the Power Monitor device as its measurement method, establishes the GPS power consumption pattern over time\ (i.e. the peaks of energy consumption at the moments when samples are taking places i.e. every 20 seconds). Also, the energy consumption of the sensors may differ depending on their parameters. SmartDC \cite{chon:smartdc} studies how power consumption of GPS and Wi-Fi scanning changes depending on their sampling interval i.e. higher sampling frequency results in higher power consumption. SmartDC also investigates the energy demands of accelerometer depending on its duty-cycling ratio\ (sampling time over sleeping interval). Smaller ratio\ (i.e. small sampling time relative to sleeping interval) results in a decrease in the power consumption of a device.  

All of those studies either only focus on few sensors (e.g. gpc, accelerometer and Wi-Fi in SmartDC \cite{chon:smartdc}) or measure sensors' power consumption only across one device \cite{benabdesslem:senseless}. To validate those results, the project aims to provide the complete set of all sensors' energy measurements across three different devices. 
	
\subsection{Energy-efficient phone sensing}
\textbf{Hierarchical relations between sensors} may be exploited for energy optimization. For example, if an user is not moving\ (it can be detected by accelerometer), its GPS coordinates are not going to change. This observation is used in Fused Location Provider \cite{android:locationapi}, a smart location framework provided by Android, and also research community e.g., SenseLess \cite{benabdesslem:senseless}. More complex examples of hierarchical relations between sensors are ACE \cite{nath:ace} and EEMMS \cite{wang:eemss}. Both of them are capable of learning relations between sensors and utilize those information to conserve energy. They leverage motion information\ (accelerometer), location and background noise. Additionally, ACE acts as a middleware, which may save an energy among many applications.

Continuous sampling results in fast battery depletion since all high-power hardware components needs to stay awake\ (LittleRock \cite{priyantha:littlerock}). To reduce energy demands, the sensor may be sampled by friction of time and stay inactive for the rest of time\ (sleeping interval). This approach is called \textbf{duty-cycling}. The sleeping interval may be adjusted depending on whether any interesting even is being detected. For example, if a user starts walking, the accelerometer sampling should be more aggressive. This adaptive sampling methodology was proposed by Rachuri et al. \cite{rachuri:dynamicsensing}. In SociableSense\cite{rachuri:socialsense} this methodology is further progressed. Sampling rate is controlled by a learning technique based on the theory of learning automata. It adapts how much sampling rate changes depending on the last history of the events. If some noise happened only once, the sampling should not be too aggressive, but if the noise keeps happening, the microphone sampling should be continuous not to miss any important events. Similar sort of ideas have been previously studied in wireless communication's field \cite{deshpande:channeling} \cite{deshpande:refocusing} \cite{deshpande:coordinated}.

\textbf{Offloading to the cloud} have been also studied for energy-efficient phone sensing. Feature extraction and classification phases are usually computation-intensive, and thus, they may be computed remotely to conserve energy. However, such approach affects latency\ (network delay) and  a user's data plan\ (network bandwidth). Different uploading strategies and their has been studied in Musolesi et al. \cite{musolesi:offloading} and Rachuri et al. \cite{rachuri:socialsense}.

The energy efficiency of phone sensing may be improved by machine learning. EnLoc \cite{constandache:enloc} leverages the logical mobility tree to schedule GPS sampling more efficient. The tree keeps the information on when a user moves and where he goes e.g. he leaves his home at 8:00 am to get to the office, which takes him 20 minutes.  If this information is known to him, GPS sampling may be only scheduled at 8:00 and 8:20 am to confirm that a user left his home and got into the office. SmartDC \cite{chon:smartdc} develops this concept further: it is capable of learning a user's mobility tree in an unsupervised manner.

There are also \textbf{other approaches} to energy-efficient phone sensing. Srinivasan et al. \cite{srinivasan:twotier} proposes two-tier activity classification. It performs smaller window of accelerometer samples to establish whether a user is walking. If  so, it performs second longer sampling to determine exact physical activity. Hsieh et al. \cite{hsieh:ipc} analyzes different Android Inter-Process Communication mechanisms for continuous sensing applications. It established metrics\ (latency, memory footprint and CPU usage) of three mechanisms: Intent, Binder and Content Provider depending on the size of payload. Those metrics are also likely to impact energy consumption. For the payload sizes smaller than 4KB (all physical sensors), the Binder performs the best on each of the metrics.

Many different approaches to phone sensing has been studied. Each of them provides energy optimization to the process of phone sensing. To conserve more energy, hybrid approaches could be developed. For example, machine learning (SmartDC \cite{chon:smartdc} only focuses on GPS sampling ) could be leveraged for adaptive sampling of accelerometer, microphone or Bluetooth\ (developed in SociableSense \cite{rachuri:socialsense}). Adaptive sampling could be also further advanced by integrating two-tier activity classification in it ( proposed in Srinivasan et al. \cite{srinivasan:twotier}). 

\subsection{Conclusions}
\hspace{10pt} In this section, the capabilities of phone sensing has been reviewed. It was concluded that those capabilities may be further improved by collecting big data set of labeled activities. In subsequent subsection, energy measurements methods were studied and suitable method for the project has been chosen. Measuring time of 1\% battery depletion has been also proposed as an improvement to full battery depletion. Furthermore, the energy efficiency of the sensors established by other studies have been presented. Finally, the approaches to energy efficient sensing has been examined. It was suggested that further improvements in the energy efficiency may be achieved by combining different approaches together e.g. leveraging machine learning and two-tier classification for adaptive sensor sampling. This section has addressed two primary objectives \ref{o:survey:review} and \ref{o:survey:enhancements}.